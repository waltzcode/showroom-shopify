(function(){"use strict";angular.module("showroomApp",["ngRoute","ngAnimate","showroomServices","showroomControllers","showroomFilters","showroomDirectives","angular-loading-bar"]),angular.module("showroomServices",["ngCookies"]),angular.module("showroomControllers",[]),angular.module("showroomFilters",[]),angular.module("showroomDirectives",[]),angular.module("showroomApp").config(["$interpolateProvider","$sceDelegateProvider","$sceProvider","$logProvider","cfpLoadingBarProvider",function(a,b,c,d,e){return a.startSymbol("{[{").endSymbol("}]}"),c.enabled(!1),d.debugEnabled(!0),e.includeSpinner=!1}]),angular.module("showroomApp").constant("SHOWROOM_CONSTANTS",{serviceHost:"//services.showroomapp.net",showroomCDN:"//cdn.showroomapp.tv/",sessionParam:"showroomSId",serviceBundleId:"showroom.ios",serviceVersion:"1.0.8",BeautyChannelId:"84fccf26862232b49f2ad44fca89c667",registerSessionURL:"/session/register",getGlobalLastestFeedURL:"/show/browse/latest/",getGlobalMostLikeFeedURL:"/show/browse/most/like/",getGlobalMostViewFeedURL:"/show/browse/most/view/",getGlobalMostShareFeedURL:"/show/browse/most/share/",getGlobalFeaturedFeedURL:"/show/browse/featured/",getFeaturedByChannelURL:"/show/browse/channel/featured/",getLastestByChannelURL:"/show/browse/channel/latest/",getMostLikeByChannelURL:"/show/browse/channel/most/like/",getMostViewByChannelURL:"/show/browse/channel/most/view/",getMostShareByChannelURL:"/show/browse/channel/most/share/",getPersonalFeedURL:"/account/me/feed/",getPersonalShowURL:"/show/me/list/",getShowByIdURL:"/show/info/",getShowByUserURL:"/show/list/by/account/",getShowByUsernameURL:"/show/list/by/username/",getListChannelURL:"/channel/list/",registerEmailAccountURL:"/account/email/register/",resetEmailAccountPasswordURL:"/account/email/resetpassword/",changeEmailAccountPasswordURL:"/account/email/changepassword/",loginEmailAccountURL:"/account/email/login/",loginFacebookAccountURL:"/account/facebook/login/",getLoggedInAccountInfoURL:"/account/me/info/",logoutURL:"/account/me/logout/",getAccountProfileURL:"/account/info/",searchAccountByKeywordsURL:"/search/account/name/",searchShowByKeywordsURL:"/search/show/product/",getProductByIdURL:"/product/info/",likeAShowURL:"/social/me/show/like/",unlikeAShowURL:"/social/me/show/unlike/",checkLikeAShowURL:"/social/me/show/islike/",commentAShowURL:"/social/me/show/comment/",removeCommentAShowURL:"/social/me/show/comment/remove/",listCommentByShowDescURL:"/social/show/list/comment/desc/",listCommentByShowAscURL:"/social/show/list/comment/asc/"}),angular.module("showroomApp").run(["$rootScope","$log","$filter","userService","channelService","SHOWROOM_CONSTANTS","$location","$q",function(a,b,c,d,e,f,g,h){return d.getLoggedInAccountInfo().then(function(b){return 1e3===b.data.code?(a.loggedIn=!0,a.userInfo=b.data.payload):void 0})["catch"](function(a){return b.error(a)}),e.getListChannel().then(function(b){var d;return 1e3===b.data.code?(d=b.data.payload.items,a.channels=c("filter")(d,{parentChannelId:f.BeautyChannelId},!0)):void 0}),a.logout=function(){return d.logout().then(function(b){return 1e3===b.data.code?(a.loggedIn=!1,a.userInfo=void 0):void 0})["catch"](function(a){return b.error(a)})},a.getUserInfo=function(){return a.userInfo?q.when(a.userInfo):d.getLoggedInAccountInfo().then(function(a){return 1e3===a.data.code?h.when(a.payload):h.when(void 0)})["catch"](function(a){return b.error(a)})},a.goToLogin=function(){var a;return a=g.path(),b.debug(a),g.path("/login").search({backUrl:a})}}]),angular.module("showroomApp").config(["$routeProvider",function(a){return a.when("/",{templateUrl:"{{ 'views-home.html' | asset_url }}",controller:"HomeController"}).when("/login",{templateUrl:"{{ 'views-login.html' | asset_url }}",controller:"LoginController"}).when("/signup",{templateUrl:"{{ 'views-signup.html' | asset_url }}",controller:"SignUpController"}).when("/featured",{templateUrl:"{{ 'views-list-show.html' | asset_url }}",controller:"FeaturedController"}).when("/popular",{templateUrl:"{{ 'views-list-show.html' | asset_url }}",controller:"PopularController"}).when("/newest",{templateUrl:"{{ 'views-list-show.html' | asset_url }}",controller:"NewestController"}).when("/myshow",{templateUrl:"{{ 'views-list-show.html' | asset_url }}",controller:"MyShowController"}).when("/search/user",{templateUrl:"{{ 'views-user-search.html' | asset_url }}",controller:"UserSearchController"}).when("/search/show",{templateUrl:"{{ 'views-show-search.html' | asset_url }}",controller:"ShowSearchController"}).when("/category/:channelId",{templateUrl:"{{ 'views-channel-detail.html' | asset_url }}",controller:"ChannelDetailController"}).when("/account/:accountId",{templateUrl:"{{ 'views-account-detail.html' | asset_url }}",controller:"AccountDetailController"}).when("/user/:username",{templateUrl:"{{ 'views-account-detail.html' | asset_url }}",controller:"UserDetailController"}).when("/show/:showId",{templateUrl:"{{ 'views-show-detail.html' | asset_url }}",controller:"ShowDetailController"}).otherwise({templateUrl:"{{ 'views-home.html' | asset_url }}",controller:"HomeController"})}]),angular.module("showroomDirectives").directive("srLazySrc",["$document","$window","$interval","$timeout","$log",function(a,b,c,d,e){var f,g,h;return g=function(){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;return k=[],p=null,o=350,j=null,i=1e3,f=0,u=angular.element(b),h=function(){var a,b,c,d,e,f,g,h,i,j,l,m;for(m=u.height(),i=u.scrollTop(),l=[],b=[],j=i,a=i+m,d=e=0,g=k.length;g>e;d=++e)c=k[d],c.isVisible(j,a)?l.push(c):b.push(c);for(f=0,h=l.length;h>f;f++)c=l[f],c.render();return k=b,s(),k.length?void 0:t()},l=function(){var b;return b=a.height(),f&&b!==f&&q(),f=b},q=function(){return null!=p?p:p=d(h,o)},s=function(){return p&&d.cancel(p),p=null},r=function(){return null==j&&(j=c(l,i)),u.on("resize.srLazySrc scroll.srLazySrc",q)},t=function(){return e.debug("Stop watching window"),j&&c.cancel(j),j=null,u.off("resize.srLazySrc scroll.srLazySrc")},g=function(a){return k.push(a),q(),j?void 0:r()},n=function(a){var b,c,d,e;for(b=d=0,e=k.length;e>d;b=++d)c=k[b],c===a&&k.splice(b,1);return k.length>0?void 0:(s(),t())},m={addImage:g,removeImage:n}}(),f=function(){function a(a){this.image=a,this.rendered=!1}return a.prototype.isVisible=function(a,b){var c,d,e,f;return this.image.is(":visible")?(d=this.image.height(),f=this.image.offset().top,c=f+d,e=f>=a&&b>=f||c>=a&&b>=c||a>=f&&c>=b):!1},a.prototype.render=function(){return this.rendered=!0,this.renderSource()},a.prototype.setSource=function(a){return this.source=a,this.rendered?this.renderSource():void 0},a.prototype.renderSource=function(){return this.image.attr("src",this.source)},a}(),h=function(a,b,c){var d;return d=new f(b),c.$observe("srLazySrc",function(a){return d.setSource(a)}),g.addImage(d),a.$on("$destroy",function(){return g.removeImage(d)})},{link:h,restrict:"A"}}]),angular.module("showroomDirectives").directive("srNavHref",["$location","$rootScope","$timeout",function(a,b,c){var d;return d=function(b,c,d){var e;return e=function(c){return b.srNavHref&&a.path(b.srNavHref),jQuery&&jQuery.shifter&&jQuery.shifter("close"),b.$apply()},c.on("click.srNavHref",e)},{restrict:"A",scope:{srNavHref:"@"},link:d}}]),angular.module("showroomDirectives").directive("srToggleSearch",["$document",function(a){var b;return b=function(b,c,d){var e;return e=a.find("body"),c.on("click.srToggleSearch",function(){return e.toggleClass("search-open")})},{restrict:"A",link:b}}]),angular.module("showroomDirectives").directive("srToggle",function(){var a;return a=function(a,b,c){var d;return d=a.toggleClass,b.on("mouseover.srToggle",function(){return b.addClass(d)}),b.on("mouseout.srToggle",function(){return b.removeClass(d)})},{restrict:"A",scope:{toggleClass:"@"},link:a}}),angular.module("showroomDirectives").directive("srVideoContainer",["$log","$timeout",function(a,b){var c,d;return d=function(){var a,c,d,e,f,g;return g=[],f=[],e={},a=function(a,b){return g.push(a),f.push(b)},d=function(a){var b,c,d,e,h;for(e=[],b=c=0,d=g.length;d>c;b=++c)h=g[b],h===a?(g.splice(b,1),e.push(f.splice(b,1))):e.push(void 0);return e},c=function(a,c){var d,e,h,i,j,k;if(!c.hasClass("playing loading")){for(e=0,i=g.length;i>e;e++)k=g[e],k[0].pause(),k.off("canplaythrough.srVideo load.srVideo");for(h=0,j=f.length;j>h;h++)d=f[h],d.removeClass("loading playing");return a[0].play(),4!==a[0].readyState?(c.addClass("loading"),a.on("canplaythrough.srVideo load.srVideo",function(){return a.off("canplaythrough.srVideo load.srVideo"),c.removeClass("loading"),c.addClass("playing"),a[0].play()}),b(function(){return a[0].pause()},1)):(c.addClass("playing"),a.on("paused.srVideo",function(){return c.removeClass("playing"),a[0].off("paused.srVideo")})),a[0].currentTime=.1}},{addVideo:a,removeVideo:d,playVideo:c}}(),c=function(a,b,c){var e;return e=b.find("video").eq(0),d.addVideo(e,b),b.on("mouseover",function(){return d.playVideo(e,b)}),a.$on("$destroy",function(){return d.removeVideo(e)})},{restrict:"A",link:c}}]),angular.module("showroomFilters").filter("jsonParse",function(){return function(a){return angular.isObject(a)?a:JSON.parse(a)}}).filter("productLink",function(){return function(a){return-1===a.indexOf("showroom-store.myshopify.com")&&-1===a.indexOf("amazon.com")&&-1===a.indexOf("store.showroomapp.tv")?"/pages/ext-product?url="+a:a}}).filter("productTarget",function(){return function(a){return-1===a.indexOf("amazon")?"_self":"_blank"}}).filter("excerptTitle",function(){return function(a,b,c){return a.length>b&&(a=a.substring(0,b),a+=c),a}}).filter("asset_url",["SHOWROOM_CONSTANTS",function(a){return function(b){return a.showroomCDN+b}}]).filter("user_avatar_url",["SHOWROOM_CONSTANTS",function(a){return function(b){return b?a.showroomCDN+b:"{{ 'no-avatar.png' | asset_url }}"}}]),angular.module("showroomServices").factory("channelService",["sessionService","$q","SHOWROOM_CONSTANTS","$log",function(a,b,c,d){return{getListChannel:function(){return a.callService("GET",c.getListChannelURL)}}}]),angular.module("showroomServices").factory("facebookService",["$q","$window",function(a,b){return{checkLoginStatus:function(){var c;return c=a.defer(),b.FB.getLoginStatus(function(a){return!a||a.erorr?c.reject(a.error||"Facebook::Error when check login status."):c.resolve(a)}),c.promise},login:function(){var c;return c=a.defer(),b.FB.login(function(a){return!a||a.erorr?c.reject(a.error||"Facebook::Error when login."):c.resolve(a)}),c.promise}}}]),angular.module("showroomServices").factory("productService",["SHOWROOM_CONSTANTS","sessionService",function(a,b){return buildUr,{getProductById:function(c){var d;return d=a.getProductByIdURL+c+"/",b.callService("GET",d)}}}]),angular.module("showroomServices").factory("sessionService",["$cookies","$http","$q","SHOWROOM_CONSTANTS","$log",function(a,b,c,d,e){return{getSessionId:function(){var e,f,g,h,i,j;return f=c.defer(),j=a.get(d.sessionParam),i=new Date,g=new Date(i.getTime()+2e6),h=function(){var a;return a=function(a){var b;return b=(Math.random().toString(16)+"000000000").substr(2,8),a?"-"+b.substr(0,4)+"-"+b.substr(4,4):b},a()+a(!0)+a(!0)+a()},e={deviceId:h(),model:"WC_MR.Richard",name:"Website Client",osName:"",osVersion:"",bundleId:d.serviceBundleId,bundleVersion:d.serviceVersion,langCode:""},j?(a.put(d.sessionParam,j,{expires:g}),f.resolve(j)):b.post(d.serviceHost+d.registerSessionURL,e).then(function(b){return 1e3===b.data.code?(a.put(d.sessionParam,b.data.payload.sessionId,{expires:g}),f.resolve(b.data.payload.sessionId)):f.reject(b.data.message)})["catch"](function(a){return f.reject(a)}),f.promise},callService:function(a,c,e){return this.getSessionId().then(function(f){var g;return g=d.serviceHost+c+f,b({url:g,method:a,data:e})})}}}]),angular.module("showroomServices").factory("showService",["SHOWROOM_CONSTANTS","sessionService",function(a,b){var c;return c=function(a,b){var c,d;return c=b.pageNumber||0,d=b.pageSize||15,a+c+"/"+d+"/"},{getGlobalLastestFeed:function(d){return b.callService("GET",c(a.getGlobalLastestFeedURL,d))},getGlobalMostLikeFeed:function(d){return b.callService("GET",c(a.getGlobalMostLikeFeedURL,d))},getGlobalMostViewFeed:function(d){return b.callService("GET",c(a.getGlobalMostViewFeedURL,d))},getGlobalMostShareFeed:function(d){return b.callService("GET",c(a.getGlobalMostShareFeedURL,d))},getGlobalFeaturedFeed:function(d){return b.callService("GET",c(a.getGlobalFeaturedFeedURL,d))},getPersonalFeed:function(d){return b.callService("GET",c(a.getPersonalFeedURL,d))},getPersonalShow:function(d){return b.callService("GET",c(a.getPersonalShowURL,d))},searchShowByKeywords:function(d){return b.callService("GET",c(a.searchShowByKeywordsURL+d.keywords+"/",d))},getShowByUser:function(d){return b.callService("GET",c(a.getShowByUserURL+d.accountId+"/",d))},getShowByUsername:function(d){return b.callService("GET",c(a.getShowByUsernameURL+d.username+"/",d))},getFeaturedByChannel:function(d){return b.callService("GET",c(a.getFeaturedByChannelURL+d.channelId+"/",d))},getShowById:function(c){var d;return d=a.getShowByIdURL+c+"/",b.callService("GET",d)}}}]),angular.module("showroomServices").factory("socialService",["SHOWROOM_CONSTANTS","sessionService",function(a,b){return{likeAShow:function(c){var d;return d=a.likeAShowURL+c+"/",b.callService("GET",d)},unlikeAShow:function(c){var d;return d=a.unlikeAShowURL+c+"/",b.callService("GET",d)},checkLikeAShow:function(c){var d;return d=a.checkLikeAShowURL+c+"/",b.callService("GET",d)},commentAShow:function(c,d){var e;return e=a.commentAShowURL+c+"/",b.callService("POST",e,d)},removeCommentAShow:function(c){var d;return d=a.removeCommentAShowURL+c+"/",b.callService("DELETE",d)},listCommentByShow:function(c){var d,e,f,g,h,i;return f=c.showId,d=c.pageNumber||0,e=c.pageSize||10,g=c.sortType||"desc",h="desc"===g?a.listCommentByShowDescURL:a.listCommentByShowAscURL,i=h+f+"/"+d+"/"+e+"/",b.callService("GET",i)}}}]),angular.module("showroomServices").factory("userService",["SHOWROOM_CONSTANTS","sessionService",function(a,b){return{registerEmailAccount:function(c){return b.callService("POST",a.registerEmailAccountURL,c)},resetEmailAccountPassword:function(c){return b.callService("POST",a.resetEmailAccountPasswordURL,c)},changeEmailAccountPassword:function(c){return b.callService("POST",a.changeEmailAccountPasswordURL,c)},loginEmailAccount:function(c){return b.callService("PUT",a.loginEmailAccountURL,c)},loginFacebookAccount:function(c){return b.callService("PUT",a.loginFacebookAccountURL,c)},getLoggedInAccountInfo:function(){return b.callService("GET",a.getLoggedInAccountInfoURL,null)},logout:function(){return b.callService("GET",a.logoutURL,null)},searchAccountByKeywords:function(c){var d,e,f,g;return d=c.keywords,e=c.pageNumber||0,f=c.pageSize||15,g=a.searchAccountByKeywordsURL+d+"/"+e+"/"+f+"/",b.callService("GET",g)},getAccountProfile:function(c){var d,e;return d=c.accountId,e=a.getAccountProfileURL+d+"/",b.callService("GET",e)}}}]),angular.module("showroomServices").factory("videoService",["SHOWROOM_CONSTANTS","socialService","$rootScope","$filter","$sce",function(a,b,c,d,e){var f,g;return g=function(b){var f,g,h,i,j,k,l,m,n;if(this.response=b.response,this.currencySymbol=b.currencySymbol||"$",this.exceprtTitleLength=b.exceprtTitleLength||32,this.excerptMore=b.excerptMore||" ...",this.videoSize=b.videoSize||"700",this.thumbnailSize=b.thumbnailSize||"700",1e3===this.response.code){for(m=this.response.payload.listShows||this.response.payload.items,k=this.response.payload.listProducts,j={},g=0,h=k.length;h>g;g++)i=k[g],j[i.id]=i;return n=function(){var b,g,h;for(h=[],f=b=0,g=m.length;g>b;f=++b)l=m[f],h.push({sources:[{src:e.trustAsResourceUrl(a.showroomCDN+l.videoSets[this.videoSize]),type:"video/mp4"}],showId:l.id,poster:e.trustAsResourceUrl(a.showroomCDN+l.thumbnailSets[this.thumbnailSize]),likeCounter:l.likeCounter,viewCounter:l.viewCounter,commentCounter:l.commentCounter,likeClick:function(){return c.loggedIn?void 0:c.goToLogin()},shareCounter:l.shareCounter,productName:d("excerptTitle")(j[l.productId].name,this.exceprtTitleLength,this.excerptMore),productTitle:j[l.productId].name,price:d("number")(j[l.productId].price,2),productLinkUrl:d("productLink")(d("jsonParse")(j[l.productId].metaData).url),productLinkTarget:d("productTarget")(d("jsonParse")(j[l.productId].metaData).url)});return h}.call(this)}},f=function(b){var c,d,f,g,h;return d=b.show,c=b.product,h=b.videoSize||"700",f=b.thumbnailSize||"700",g={sources:[{src:e.trustAsResourceUrl(a.showroomCDN+d.videoSets[h]),type:"video/mp4"}],poster:e.trustAsResourceUrl(a.showroomCDN+d.thumbnailSets[f])}},{parseVideo:g,parseSingleVideo:f}}]),angular.module("showroomControllers").controller("AccountDetailController",["$scope","$rootScope","showService","userService","$log","$routeParams","videoService",function(a,b,c,d,e,f,g){return b.removeHeader=!1,b.removeBrand=!1,b.removeNav=!1,b.removeFooter=!1,a.header="Account Show",a.currentPage=0,a.hasMore=!0,a.totalItem=0,a.loadMore=function(){return c.getShowByUser({accountId:f.accountId,pageNumber:a.currentPage++}).then(function(b){return 1e3===b.data.code?a.videos&&angular.isArray(a.videos)?a.videos=a.videos.concat(g.parseVideo({response:b.data})):a.videos=g.parseVideo({response:b.data}):e.error(b.data.message),b.data.payload&&a.videos.length>=a.totalItem?a.hasMore=!1:void 0})},d.getAccountProfile({accountId:f.accountId}).then(function(b){var c;return 1e3===b.data.code&&(c=b.data.payload.accountInfo,a.totalItem=b.data.payload.showCounter,a.header=c.firstName+" "+c.lastName+" SHOW"),a.loadMore()})}]),angular.module("showroomControllers").controller("ChannelDetailController",["$scope","$rootScope","showService","$log","$routeParams","videoService",function(a,b,c,d,e,f){return b.removeHeader=!1,b.removeBrand=!1,b.removeNav=!1,b.removeFooter=!1,a.currentPage=0,a.hasMore=!0,a.loadMore=function(){return c.getFeaturedByChannel({channelId:e.channelId,pageNumber:a.currentPage++}).then(function(b){return 1e3!==b.data.code?d.error(b.data.message):(a.header=b.data.payload.channel.name+" Category",a.videos&&angular.isArray(a.videos)?a.videos=a.videos.concat(f.parseVideo({response:b.data})):a.videos=f.parseVideo({response:b.data}),b.data.payload&&a.videos.length>=b.data.payload.totalItem?a.hasMore=!1:void 0)})},a.loadMore()}]),angular.module("showroomControllers").controller("FeaturedController",["$scope","$rootScope","showService","videoService","$log","SHOWROOM_CONSTANTS",function(a,b,c,d,e,f){return b.removeHeader=!1,b.removeBrand=!1,b.removeNav=!1,b.removeFooter=!1,a.header="Featured",a.currentPage=0,a.hasMore=!0,a.loadMore=function(){return c.getFeaturedByChannel({channelId:f.BeautyChannelId,pageNumber:a.currentPage++}).then(function(b){return angular.isArray(a.videos)?a.videos=a.videos.concat(d.parseVideo({response:b.data})):a.videos=d.parseVideo({response:b.data}),b.data.payload&&a.videos.length>=b.data.payload.totalItem?a.hasMore=!1:void 0})},a.loadMore()}]),angular.module("showroomControllers").controller("HeaderController",["$scope","$location","channelService","$log","$filter","SHOWROOM_CONSTANTS",function(a,b,c,d,e,f){return c.getListChannel().then(function(b){var c;return 1e3===b.data.code?(c=b.data.payload.items,a.channels=e("filter")(c,{parentChannelId:f.BeautyChannelId},!0)):void 0})}]),angular.module("showroomControllers").controller("HomeController",["showService","videoService","$scope","$rootScope","$log",function(a,b,c,d,e){return d.removeHeader=!1,d.removeBrand=!1,d.removeNav=!1,d.removeFooter=!1,d.loggedIn&&(a.getPersonalFeed({pageNumber:0,pageSize:15}).then(function(a){return c.myFeedVideos=b.parseVideo({response:a.data})}),a.getPersonalShow({pageNumber:0,pageSize:15}).then(function(a){return c.myShowVideos=b.parseVideo({response:a.data})})),a.getGlobalFeaturedFeed({pageNumber:0,pageSize:15}).then(function(a){return c.featuredVideos=b.parseVideo({response:a.data})}),a.getGlobalMostLikeFeed({pageNumber:0,pageSize:15}).then(function(a){return c.popularVideos=b.parseVideo({response:a.data})}),a.getGlobalLastestFeed({pageNumber:0,pageSize:15}).then(function(a){return c.newestVideos=b.parseVideo({response:a.data})})}]),angular.module("showroomControllers").controller("LoginController",["userService","facebookService","$scope","$rootScope","$log","$location",function(a,b,c,d,e,f){return d.removeHeader=!0,d.removeBrand=!0,d.removeNav=!0,d.removeFooter=!0,c.errors=[],d.loggedIn&&f.patch("/"),c.email="",c.password="",c.backUrl=f.search().backUrl,null==c.backUrl&&(c.backUrl="/"),c.loginEmail=function(){return c.loginForm.$invalid?c.showMessages=!0:a.loginEmailAccount({email:c.email,password:c.password}).then(function(b){return 1e3===b.data.code?(d.loggedIn=!0,a.getLoggedInAccountInfo().then(function(a){return 1e3===a.data.code?d.userInfo=a.data.payload:void 0})["finally"](function(){return f.path(c.backUrl).search("").replace()})):c.message="Email or password is invalid."})["catch"](function(a){return c.message="Internal server error",e.error(a)})},c.connectFacebook=function(){return b.login().then(function(b){return"connected"===b.status?a.loginFacebookAccount({socialToken:b.authResponse.accessToken}):new Error("Nothing")}).then(function(b){return 1e3===b.data.code?(d.loggedIn=!0,a.getLoggedInAccountInfo().then(function(a){return 1e3===a.data.code?d.userInfo=a.data.payload:void 0})["finally"](function(){return f.path(c.backUrl).search("").replace()})):void 0})["catch"](function(a){return e.error(a)})},c.popupForgetPwd=function(){return $.fancybox({href:"#forgot-password"})}}]).controller("ForgotPwdController",["$scope","userService","$log",function(a,b,c){return a.headerText="FORGOT PASSWORDS?",a.message="<p>Having a hard time remembering your SHOWROOM password? No worries. </p><p>We'll email you a link to reset it.</p>",a.sendEmail=function(){return a.forgotPasswordForm.$valid?b.resetEmailAccountPassword({email:a.email}).then(function(b){return 1e3===b.data.code?(a.resetSuccess=!0,a.headerText="You're almost back to SHOWROOM.",a.message="<p>We've just sent an email that includes instructions and a link to reset your password.</p> <p>We'll have you back to the SHOWROOM in no time!</p>"):(a.headerText="FAIL!",a.message="<p>"+b.data.message+"</p>")})["catch"](function(a){return c.error(a)}):a.showForgotMessages=!0}}]),angular.module("showroomControllers").controller("MyShowController",["$scope","$rootScope","showService","videoService","$log",function(a,b,c,d,e){return b.removeHeader=!1,b.removeBrand=!1,b.removeNav=!1,b.removeFooter=!1,a.header="My shows",a.pageNumber=0,a.hasMore=!0,b.loggedIn?(a.loadMore=function(){return c.getPersonalShow({pageNumber:a.pageNumber++,pageSize:15}).then(function(b){return a.videos&&angular.isArray(a.videos)?a.videos=a.videos.concat(d.parseVideo({response:b.data})):a.videos=d.parseVideo({response:b.data}),a.videos.length>=b.data.payload.totalItem?a.hasMore=!1:void 0})},a.loadMore()):void 0}]),angular.module("showroomControllers").controller("NewestController",["$scope","$rootScope","showService","videoService","$log",function(a,b,c,d,e){return b.removeHeader=!1,b.removeBrand=!1,b.removeNav=!1,b.removeFooter=!1,a.header="Newest",a.currentPage=0,a.hasMore=!0,a.loadMore=function(){return c.getGlobalLastestFeed({pageNumber:a.currentPage++,pageSize:15}).then(function(b){return angular.isArray(a.videos)?a.videos=a.videos.concat(d.parseVideo({response:b.data})):a.videos=d.parseVideo({response:b.data}),b.data.payload&&a.videos.length>=b.data.payload.totalItem?a.hasMore=!1:void 0})},a.loadMore()}]),angular.module("showroomControllers").controller("PopularController",["$scope","$rootScope","showService","videoService","$log",function(a,b,c,d,e){return b.removeHeader=!1,b.removeBrand=!1,b.removeNav=!1,b.removeFooter=!1,a.header="Popular",a.currentPage=0,a.hasMore=!0,a.loadMore=function(){return c.getGlobalMostLikeFeed({pageNumber:a.currentPage++,pageSize:15}).then(function(b){return angular.isArray(a.videos)?a.videos=a.videos.concat(d.parseVideo({response:b.data})):a.videos=d.parseVideo({response:b.data}),b.data.payload&&a.videos.length>=b.data.payload.totalItem?a.hasMore=!1:void 0})},a.loadMore()}]),angular.module("showroomControllers").controller("SearchFormController",["$location","$scope",function(a,b){var c,d,e;if(d=a.path(),e=a.search(),e.q)switch(d){case"/search/user":b.userKeywords=e.q;break;case"/search/show":b.showKeywords=e.q}return c=function(){return jQuery&&jQuery.shifter?jQuery.shifter("close"):void 0},b.searchUser=function(){return b.userKeywords?(b.showKeywords="",c(),a.search("q",b.userKeywords),a.path("/search/user")):void 0},b.searchShow=function(){return b.showKeywords?(b.userKeywords="",c(),a.search("q",b.showKeywords),a.path("/search/show")):void 0}}]),angular.module("showroomControllers").controller("ShowDetailController",["$scope","showService","socialService","$filter","$log","$routeParams","videoService","$location","$rootScope",function(a,b,c,d,e,f,g,h,i){var j;return i.removeHeader=!1,i.removeBrand=!1,i.removeNav=!1,i.removeFooter=!1,j=f.showId,j||h.path("/").replace(),a.showId=j,a.likeClick=function(b){return i.loggedIn||i.goToLogin(),a.isLiked?c.unlikeAShow(j).then(function(b){return 1e3===b.data.code?(a.isLiked=!1,a.likeCounter--):void 0}):c.likeAShow(j).then(function(b){return 1e3===b.data.code?(a.isLiked=!0,a.likeCounter++):void 0})},a.loadShow=function(){return b.getShowById(j).then(function(b){var c,e,f,i,j;return b.data&&1e3===b.data.code||h.path("/"),c=b.data.payload,j=c.ShowInfo,e=c.ProductInfo,angular.isObject(e.metaData)||(f=JSON.parse(e.metaData)),i=f.url,a.productName=e.name,a.productPrice=d("number")(e.price,2),a.productUrl=d("productLink")(i),a.productTarget=d("productTarget")(i),a.productBrief=e.brief,a.productCategoryId=e.productCategoryId,a.video=g.parseSingleVideo({show:c.ShowInfo,product:c.ProductInfo}),a.likeCounter=j.likeCounter,a.viewCounter=j.viewCounter,a.commentCounter=j.commentCounter,a.shareCounter=j.shareCounter,a.isLiked=c.liked,a.isFollowed=c.isFollow})["catch"](function(a){return e.error(a)})},a.loadShow()}]),angular.module("showroomControllers").controller("ShowCommentController",["$scope","$rootScope","socialService","$log","$routeParams","videoService",function(a,b,c,d,e,f){var g,h,i,j;return j=a.$parent.showId,a.commentCounter=a.$parent.commentCounter,a.currentPage=0,g={},h=function(a){var b;return b=g[a],b?b.firstName+" "+b.lastName:""},i=function(a){var b,c,d,e,f,g;if(e=a.match(/\|`\|(\w+)\|`\|/g),!e||e.length<=0)return a;for(f=0,g=e.length;g>f;f++)b=e[f],c=b.slice(3,b.length-3),d="<b>"+h(c)+"</b>",a=a.replace(b,d);return"<p>"+a+"</p>"},a.deleteComment=function(b){return c.removeCommentAShow(b).then(function(b){return 1e3===b.data.code?a.loadCommment():void 0})},a.commit=function(b){return a.commentForm.$valid?c.commentAShow(j,{comment:a.commentText}).then(function(b){return 1e3===b.data.code?(a.loadCommment(),a.commentText=""):void 0}):void 0},a.loadCommment=function(){return c.listCommentByShow({showId:j,pageSize:10,sortType:"desc"}).then(function(c){var d,e,f,j,k,l,m,n;if(1e3===c.data.code){for(n=c.data.payload,m=n.items.reverse(),l=n.listAccounts,j=0,k=l.length;k>j;j++)d=l[j],g[d.accountId]=d;return e=function(a){return b.loggedIn&&b.userInfo?b.userInfo.accountId===a:!1},a.comments=function(){var a,b,c;for(c=[],a=0,b=m.length;b>a;a++)f=m[a],c.push({socialActionId:f.id,authorName:h(f.accountId),authorAvatarUrl:g[f.accountId].avatarUrl,updatedAt:f.updatedAt,content:i(f.metaData.comment),isMime:e(f.accountId)});return c}()}})},a.loadCommment()}]),angular.module("showroomControllers").controller("ShowSearchController",["showService","videoService","$scope","$rootScope","$location","$log",function(a,b,c,d,e,f){return d.removeHeader=!1,d.removeBrand=!1,d.removeNav=!1,d.removeFooter=!1,$("body").hasClass("search-open")||$("body").addClass("search-open"),c.keywords=e.search().q,c.header="Search result for show - '"+c.keywords+"'",c.currentPage=0,c.hasMore=!0,c.loadMore=function(){return a.searchShowByKeywords({keywords:c.keywords,pageNumber:c.currentPage++}).then(function(a){return angular.isArray(c.videos)?c.videos=c.videos.concat(b.parseVideo({response:a.data})):c.videos=b.parseVideo({response:a.data}),a.data.payload&&c.videos.length>=a.data.payload.totalItem?c.hasMore=!1:void 0})},c.loadMore()}]),angular.module("showroomControllers").controller("SignUpController",["$scope","$rootScope","userService","$log","$location",function(a,b,c,d,e){return b.removeHeader=!0,b.removeBrand=!0,b.removeNav=!0,b.removeFooter=!0,a.signup=function(){return a.showMessages=!0,a.signupForm.$valid?c.registerEmailAccount({email:a.email,password:a.password,firstName:a.firstName,lastName:a.lastName}).then(function(f){return 1e3===f.code?c.loginEmailAccount({email:a.email,password:a.password}).then(function(f){return 1e3!==f.data.code?a.message="Email or password is invalid.":(b.loggedIn=!0,f.data.code===1e3["catch"](function(a){return d.error(a)})["finally"](function(){return e.path("/")})?c.getLoggedInAccountInfo().then(f(b.userInfo=f.payload)):void 0)})["catch"](function(b){return d.error(b),a.message="Internal server error."}):a.message=f.message})["catch"](function(b){return d.error(b),a.message=b}):void 0}}]),angular.module("showroomControllers").controller("UserDetailController",["$scope","$rootScope","showService","userService","$log","$routeParams","videoService",function(a,b,c,d,e,f,g){return b.removeHeader=!1,b.removeBrand=!1,b.removeNav=!1,b.removeFooter=!1,a.header="Account Show",a.currentPage=0,a.hasMore=!0,a.totalItem=0,a.loadMore=function(){return c.getShowByUsername({username:f.username,pageNumber:a.currentPage++}).then(function(b){return 1e3===b.data.code?a.videos&&angular.isArray(a.videos)?a.videos=a.videos.concat(g.parseVideo({response:b.data})):a.videos=g.parseVideo({response:b.data}):e.error(b.data.message),b.data.payload&&a.videos.length>=a.totalItem?a.hasMore=!1:void 0})},a.loadMore()}]),angular.module("showroomControllers").controller("UserSearchController",["userService","$scope","$rootScope","$location","$log",function(a,b,c,d,e){return c.removeHeader=!1,c.removeBrand=!1,c.removeNav=!1,c.removeFooter=!1,$("body").hasClass("search-open")||$("body").addClass("search-open"),b.keywords=d.search().q,a.searchAccountByKeywords({keywords:b.keywords}).then(function(a){return b.header="Search result for user - '"+b.keywords+"'",1e3===a.data.code&&(b.users=a.data.payload.items),1e3!==a.data.code?b.message=a.data.message:void 0})}])}).call(this);