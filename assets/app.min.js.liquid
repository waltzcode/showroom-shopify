(function(){"use strict";var a,b,c,d,e;a=angular.module("showroomApp",["ngRoute","showroomServices","showroomControllers","showroomFilters","showroomDirectives"]),e=angular.module("showroomServices",["ngCookies","ngSanitize","com.2fdevs.videogular","com.2fdevs.videogular.plugins.poster"]),b=angular.module("showroomControllers",[]),d=angular.module("showroomFilters",[]),c=angular.module("showroomDirectives",[]),a.constant("SHOWROOM_CONSTANTS",{serviceHost:"//services.showroomapp.net",sessionParam:"showroomSId",serviceBundleId:"showroom.ios",serviceVersion:"1.0.8",registerSessionURL:"/session/register",getGlobalLastestFeedURL:"/feed/latest/",getGlobalMostLikeFeedURL:"/feed/most/like/",getGlobalMostViewFeedURL:"/feed/most/view/",getGlobalMostShareFeedURL:"/feed/most/share/",getGlobalFeaturedFeedURL:"/feed/featured/",getPersonalFeedURL:"/account/me/feed/",getPersonalShowURL:"/show/me/list/",registerEmailAccountURL:"/account/email/register/",resetEmailAccountPasswordURL:"/account/email/resetpassword/",changeEmailAccountPasswordURL:"/account/email/changepassword/",loginEmailAccountURL:"/account/email/login/",loginFacebookAccountURL:"/account/facebook/login/",getLoggedInAccountInfoURL:"/account/me/info/",searchAccountByKeywordsURL:"/search/account/name/",searchShowByKeywordsURL:"/search/show/product/",logoutURL:"/account/me/logout/",showroomCDN:"//cdn.showroomapp.tv/"}),a.config(["$interpolateProvider","$sceDelegateProvider","$sceProvider",function(a,b,c){return a.startSymbol("{[{").endSymbol("}]}"),b.resourceUrlWhitelist(["self","http://cdn.shopify.com/**","https://cdn.shopify.com/**"]),c.enabled(!1)}]),a.run(["$rootScope","$log","userService","$q",function(a,b,c,d){return c.getLoggedInAccountInfo().then(function(b){return 1e3===b.code?(a.loggedIn=!0,a.userInfo=b.payload):void 0})["catch"](function(a){return b.error(a)}),a.logout=function(){return c.logout().then(function(b){return a.loggedIn=!1,a.userInfo=void 0})["catch"](function(a){return b.error(a)})}}]),angular.module("showroomApp").config(["$routeProvider",function(a){return a.when("/",{templateUrl:"{{ 'views-home.html' | asset_url }}",controller:"HomeController"}).when("/login",{templateUrl:"{{ 'views-login.html' | asset_url }}",controller:"LoginController"}).when("/signup",{templateUrl:"{{ 'views-signup.html' | asset_url }}",controller:"SignUpController"}).when("/featured",{templateUrl:"{{ 'views-list-show.html' | asset_url }}",controller:"FeaturedController"}).when("/popular",{templateUrl:"{{ 'views-list-show.html' | asset_url }}",controller:"PopularController"}).when("/newest",{templateUrl:"{{ 'views-list-show.html' | asset_url }}",controller:"NewestController"}).when("/myshow",{templateUrl:"{{ 'views-list-show.html' | asset_url }}",controller:"MyShowController"}).when("/user/search",{templateUrl:"{{ 'views-user-search.html' | asset_url }}",controller:"UserSearchController"}).when("/show/search",{templateUrl:"{{ 'views-show-search.html' | asset_url }}",controller:"ShowSearchController"}).otherwise({templateUrl:"{{ 'views-home.html' | asset_url }}",controller:"HomeController"})}]),angular.module("showroomServices").factory("facebookService",["$q","$window",function(a,b){return{checkLoginStatus:function(){var c;return c=a.defer(),b.FB.getLoginStatus(function(a){return!a||a.erorr?c.reject(a.error||"Facebook::Error when check login status."):c.resolve(a)}),c.promise},login:function(){var c;return c=a.defer(),b.FB.login(function(a){return!a||a.erorr?c.reject(a.error||"Facebook::Error when login."):c.resolve(a)}),c.promise}}}]),angular.module("showroomServices").factory("sessionService",["$cookies","$http","$q","SHOWROOM_CONSTANTS","$log",function(a,b,c,d,e){return{getSessionId:function(){var e,f,g,h,i,j;return f=c.defer(),j=a.get(d.sessionParam),i=new Date,g=new Date(i.getTime()+2e6),h=function(){var a;return a=function(a){var b;return b=(Math.random().toString(16)+"000000000").substr(2,8),a?"-"+b.substr(0,4)+"-"+b.substr(4,4):b},a()+a(!0)+a(!0)+a()},e={deviceId:h(),model:"WC_MR.Richard",name:"Website Client",osName:"",osVersion:"",bundleId:d.serviceBundleId,bundleVersion:d.serviceVersion,langCode:""},j?(a.put(d.sessionParam,j,{expires:g}),f.resolve(j)):b.post(d.serviceHost+d.registerSessionURL,e).then(function(b){return 1e3===b.data.code?(a.put(d.sessionParam,b.data.payload.sessionId,{expires:g}),f.resolve(b.data.payload.sessionId)):f.reject(b.data.message)})["catch"](function(a){return f.reject(a)}),f.promise},callService:function(a,c,e){return this.getSessionId().then(function(f){var g;return g=d.serviceHost+c+f,b({url:g,method:a,data:e})})}}}]),angular.module("showroomServices").factory("showService",["SHOWROOM_CONSTANTS","sessionService",function(a,b){var c;return c=function(a,b){var c,d;return c=b.pageNumber||0,d=b.pageSize||15,a+c+"/"+d+"/"},{getGlobalLastestFeed:function(d){return b.callService("GET",c(a.getGlobalLastestFeedURL,d))},getGlobalMostLikeFeed:function(d){return b.callService("GET",c(a.getGlobalMostLikeFeedURL,d))},getGlobalMostViewFeed:function(d){return b.callService("GET",c(a.getGlobalMostViewFeedURL,d))},getGlobalMostShareFeed:function(d){return b.callService("GET",c(a.getGlobalMostShareFeedURL,d))},getGlobalFeaturedFeed:function(d){return b.callService("GET",c(a.getGlobalFeaturedFeedURL,d))},getPersonalFeed:function(d){return b.callService("GET",c(a.getPersonalFeedURL,d))},getPersonalShow:function(d){return b.callService("GET",c(a.getPersonalShowURL,d))},searchShowByKeywords:function(c){var d,e,f,g;return d=c.keywords,e=c.pageNumber||0,f=c.pageSize||15,g=a.searchShowByKeywordsURL+d+"/"+e+"/"+f+"/",b.callService("GET",g)}}}]),angular.module("showroomServices").factory("userService",["SHOWROOM_CONSTANTS","sessionService",function(a,b){return{registerEmailAccount:function(c){return b.callService("POST",a.registerEmailAccountURL,c)},resetEmailAccountPassword:function(c){return b.callService("POST",a.resetEmailAccountPasswordURL,c)},changeEmailAccountPassword:function(c){return b.callService("POST",a.changeEmailAccountPasswordURL,c)},loginEmailAccount:function(c){return b.callService("PUT",a.loginEmailAccountURL,c)},loginFacebookAccount:function(c){return b.callService("PUT",a.loginFacebookAccountURL,c)},getLoggedInAccountInfo:function(){return b.callService("GET",a.getLoggedInAccountInfoURL,null)},logout:function(){return b.callService("GET",a.logoutURL,null)},searchAccountByKeywords:function(c){var d,e,f,g;return d=c.keywords,e=c.pageNumber||0,f=c.pageSize||15,g=a.searchAccountByKeywordsURL+d+"/"+e+"/"+f+"/",b.callService("GET",g)}}}]),angular.module("showroomServices").factory("videoService",["SHOWROOM_CONSTANTS","VG_STATES","$filter","$sce","$rootScope",function(a,b,c,d,e){var f;return f=function(f){var g,h,i,j,k;return this.response=f.response,this.currencySymbol=f.currencySymbol||"$",this.exceprtTitleLength=f.exceprtTitleLength||30,this.excerptMore=f.excerptMore||"...",this.videoSize=f.videoSize||"400",this.thumbnailSize=f.thumbnailSize||"700",1e3===this.response.code?(j=this.response.payload.listShows||this.response.payload.items,h=this.response.payload.listProducts,k=function(){var f,k,l;for(l=[],g=f=0,k=j.length;k>f;g=++f)i=j[g],l.push({preload:"none",sources:[{src:d.trustAsResourceUrl(a.showroomCDN+i.videoSets[this.videoSize]),type:"video/mp4"}],poster:d.trustAsResourceUrl(a.showroomCDN+i.thumbnailSets[this.thumbnailSize]),onPlayerReady:function(a){return this.API=a},play:function(){return e.currentAPI&&e.currentAPI.currentState===b.PLAY&&e.currentAPI.stop(),this.API&&this.API.currentAPI!==b.PLAY?(e.currentAPI=this.API,this.API.play()):void 0},likeCounter:i.likeCounter,viewCounter:i.viewCounter,commentCounter:i.commentCounter,shareCounter:i.shareCounter,productName:c("excerptTitle")(h[g].name,this.exceprtTitleLength,this.excerptMore),productTitle:h[g].name,price:c("currency")(h[g].price,this.currencySymbol,2),productLinkUrl:c("productLink")(c("jsonParse")(h[g].metaData).url),productLinkTarget:c("productTarget")(c("jsonParse")(h[g].metaData).url)});return l}.call(this)):void 0},{parseVideo:f}}]),angular.module("showroomControllers").controller("FeaturedController",["$scope","showService","videoService","$log",function(a,b,c,d){return a.header="Featured",b.getGlobalFeaturedFeed({pageNumber:0,pageSize:15}).then(function(b){return a.videos=c.parseVideo({response:b.data})})}]),angular.module("showroomControllers").controller("HeaderController",["$scope","$location",function(a,b){return a.searchUser=function(){return a.userKeywords?(b.search("q",a.userKeywords),b.path("/user/search")):void 0},a.searchShow=function(){return a.showKeywords?(b.search("q",a.showKeywords),b.path("/show/search")):void 0}}]),angular.module("showroomControllers").controller("HomeController",["showService","videoService","$scope","$rootScope","$log","$q","$location",function(a,b,c,d,e,f,g){return d.removeHeader=!1,d.removeBrand=!1,d.removeNav=!1,d.removeFooter=!1,d.loggedIn&&(a.getPersonalFeed({pageNumber:0,pageSize:15}).then(function(a){return c.myFeedVideos=b.parseVideo({response:a.data})}),a.getPersonalShow({pageNumber:0,pageSize:15}).then(function(a){return c.myShowVideos=b.parseVideo({response:a.data})})),a.getGlobalFeaturedFeed({pageNumber:0,pageSize:15}).then(function(a){return c.featuredVideos=b.parseVideo({response:a.data})}),a.getGlobalMostLikeFeed({pageNumber:0,pageSize:15}).then(function(a){return c.popularVideos=b.parseVideo({response:a.data})}),a.getGlobalLastestFeed({pageNumber:0,pageSize:15}).then(function(a){return c.newestVideos=b.parseVideo({response:a.data})})}]),angular.module("showroomControllers").controller("LoginController",["userService","facebookService","$scope","$rootScope","$log","$location",function(a,b,c,d,e,f){return d.removeHeader=!0,d.removeBrand=!0,d.removeNav=!0,d.removeFooter=!0,c.errors=[],d.loggedIn&&f.patch("/"),c.email="",c.password="",c.loginEmail=function(){return c.loginForm.$invalid?c.showMessages=!0:a.loginEmailAccount({email:c.email,password:c.password}).then(function(b){return 1e3===b.data.code?(d.loggedIn=!0,a.getLoggedInAccountInfo().then(function(a){return 1e3===a.data.code?d.userInfo=a.data.payload:void 0})["finally"](function(){return f.path("/")})):c.message="Email or password is invalid."})["catch"](function(a){return c.message="Internal server error",e.error(a)})},c.connectFacebook=function(){return b.login().then(function(b){return"connected"===b.status?a.loginFacebookAccount({socialToken:b.authResponse.accessToken}):new Error("Nothing")}).then(function(b){return 1e3===b.data.code?(d.loggedIn=!0,a.getLoggedInAccountInfo().then(function(a){return 1e3===a.data.code?d.userInfo=a.data.payload:void 0})["finally"](function(){return f.path("/")})):void 0})["catch"](function(a){return e.error(a)})},c.popupForgetPwd=function(){return $.fancybox({href:"#forgot-password"})}}]).controller("ForgotPwdController",["$scope","userService","$log",function(a,b,c){return a.headerText="FORGOT PASSWORDS?",a.message="<p>Having a hard time remembering your SHOWROOM password? No worries. </p><p>We'll email you a link to reset it.</p>",a.sendEmail=function(){return a.forgotPasswordForm.$valid?b.resetEmailAccountPassword({email:a.email}).then(function(b){return 1e3===b.data.code?(a.resetSuccess=!0,a.headerText="You're almost back to SHOWROOM.",a.message="<p>We've just sent an email that includes instructions and a link to reset your password.</p> <p>We'll have you back to the SHOWROOM in no time!</p>"):(a.headerText="FAIL!",a.message="<p>"+b.data.message+"</p>")})["catch"](function(a){return c.error(a)}):a.showForgotMessages=!0}}]),angular.module("showroomControllers").controller("MyShowController",["$scope","$rootScope","showService","videoService","$log",function(a,b,c,d,e){return a.header="My shows",b.loggedIn?c.getPersonalShow({pageNumber:0,pageSize:15}).then(function(b){return a.videos=d.parseVideo({response:b.data})}):void 0}]),angular.module("showroomControllers").controller("NewestController",["$scope","showService","videoService","$log",function(a,b,c,d){return a.header="Newest",b.getGlobalMostLikeFeed({pageNumber:0,pageSize:15}).then(function(b){return a.videos=c.parseVideo({response:b.data})})}]),angular.module("showroomControllers").controller("PopularController",["$scope","showService","videoService","$log",function(a,b,c,d){return a.header="Popular",b.getGlobalMostLikeFeed({pageNumber:0,pageSize:15}).then(function(b){return a.videos=c.parseVideo({response:b.data})})}]),angular.module("showroomControllers").controller("ShowSearchController",["showService","videoService","$scope","$location","$log",function(a,b,c,d,e){return c.keywords=d.search().q,a.searchShowByKeywords({keywords:c.keywords}).then(function(a){return c.header="Search result for '"+c.keywords+"'",1e3===a.data.code&&(c.shows=a.data.payload.items),c.totalItem=a.data.payload.totalItem,c.videos=b.parseVideo({response:a.data}),1e3!==a.data.code?c.message=a.data.message:void 0})}]),angular.module("showroomControllers").controller("SignUpController",["$scope","$rootScope","userService","$log","$location",function(a,b,c,d,e){return b.removeHeader=!0,b.removeBrand=!0,b.removeNav=!0,b.removeFooter=!0,a.signup=function(){return a.showMessages=!0,a.signupForm.$valid?c.registerEmailAccount({email:a.email,password:a.password,firstName:a.firstName,lastName:a.lastName}).then(function(f){return 1e3===f.code?c.loginEmailAccount({email:a.email,password:a.password}).then(function(f){return 1e3!==f.data.code?a.message="Email or password is invalid.":(b.loggedIn=!0,f.data.code===1e3["catch"](function(a){return d.error(a)})["finally"](function(){return e.path("/")})?c.getLoggedInAccountInfo().then(f(b.userInfo=f.payload)):void 0)})["catch"](function(b){return d.error(b),a.message="Internal server error."}):a.message=f.message})["catch"](function(b){return d.error(b),a.message=b}):void 0}}]),angular.module("showroomControllers").controller("UserSearchController",["userService","$scope","$location","$log",function(a,b,c,d){return b.keywords=c.search().q,a.searchAccountByKeywords({keywords:b.keywords}).then(function(a){return 1e3===a.data.code&&(b.users=a.data.payload.items),1e3!==a.data.code?b.message=a.data.message:void 0})}]),angular.module("showroomFilters").filter("jsonParse",function(){return function(a){return angular.isObject(a)?a:JSON.parse(a)}}).filter("productLink",function(){return function(a){return-1===a.indexOf("showroom-store.myshopify.com")&&-1===a.indexOf("amazon.com")&&-1===a.indexOf("store.showroomapp.tv")?"/pages/ext-product?url="+a:a}}).filter("productTarget",function(){return function(a){return a.indexOf(!1)?"_self":"_blank"}}).filter("excerptTitle",function(){return function(a,b,c){return a.length>b&&(a=a.substring(0,b),a=a.substring(0,a.lastIndexOf(" ")+1),a+=c),a}}).filter("asset_url",["SHOWROOM_CONSTANTS",function(a){return function(b){return a.showroomCDN+b}}])}).call(this);